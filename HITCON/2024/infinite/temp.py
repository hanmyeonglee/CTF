NA = {
    "team_token": "2544876c41de80488474ee6f64b3f25d",
    "target_product": "`N/A`",
    "recipes": [
        {
            "product": "`N/A`",
            "materials": [
                "Astral Disintegration",
                "Black Hole",
                "Extreme Thunder",
                "Fury",
                "Mega Explosion",
                "Pyroclastic Storm",
                "Wind",
                "thunder"
            ]
        }
    ]
}

AD = {
 "team_token": "2544876c41de80488474ee6f64b3f25d",
 "target_product": "Astral Disintegration",
 "recipes": [
  {
   "product": "Glacier",
   "materials": [
    "earth",
    "earth",
    "earth",
    "earth",
    "mountain",
    "water",
    "water",
    "wind"
   ]
  },
  {
   "product": "Electrical Discharge",
   "materials": [
    "Lightning Storm",
    "earth",
    "fire",
    "sky",
    "sky",
    "thunder",
    "thunder",
    "thunder"
   ]
  },
  {
   "product": "Electricity",
   "materials": [
    "Aether",
    "Aether",
    "Lightning",
    "Lightning",
    "N/A",
    "mountain",
    "sky",
    "thunder"
   ]
  },
  {
   "product": "storm",
   "materials": [
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "sky",
    "thunder",
    "thunder"
   ]
  },
  {
   "product": "Hurricane",
   "materials": [
    "earth",
    "earth",
    "earth",
    "mountain",
    "sky",
    "thunder",
    "wind",
    "wind"
   ]
  },
  {
   "product": "Singularity",
   "materials": [
    "Aether",
    "Aether",
    "Glacier",
    "Glacier",
    "Molten Lava",
    "Molten Lava",
    "Plasma",
    "Plasma"
   ]
  },
  {
   "product": "Overcharged",
   "materials": [
    "Electrical Discharge",
    "Electrical Discharge",
    "Lightning Storm",
    "Lightning Storm",
    "fire",
    "sky",
    "thunder",
    "thunder"
   ]
  },
  {
   "product": "Intensified Electricity",
   "materials": [
    "Electricity",
    "Electricity",
    "Electricity",
    "Electricity",
    "Lightning",
    "Lightning",
    "Lightning",
    "Lightning"
   ]
  },
  {
   "product": "Extreme Fire",
   "materials": [
    "Aether",
    "Plasma",
    "fire",
    "fire",
    "fire",
    "fire",
    "sky",
    "sky"
   ]
  },
  {
   "product": "Maelstrom",
   "materials": [
    "earth",
    "lake",
    "lake",
    "lake",
    "sky",
    "thunder",
    "thunder",
    "water"
   ]
  },
  {
   "product": "Volcanic Eruption",
   "materials": [
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "fire",
    "lake",
    "thunder"
   ]
  },
  {
   "product": "Waterfall",
   "materials": [
    "earth",
    "earth",
    "fire",
    "lake",
    "lake",
    "lake",
    "mountain",
    "wind"
   ]
  },
  {
   "product": "Overflow",
   "materials": [
    "lake",
    "mountain",
    "thunder",
    "water",
    "water",
    "wind",
    "wind",
    "wind"
   ]
  },
  {
   "product": "Aether",
   "materials": [
    "earth",
    "fire",
    "sky",
    "sky",
    "sky",
    "sky",
    "sky",
    "sky"
   ]
  },
  {
   "product": "N/A",
   "materials": [
    "earth",
    "earth",
    "earth",
    "fire",
    "lake",
    "sky",
    "sky",
    "wind"
   ]
  },
  {
   "product": "Lightning",
   "materials": [
    "fire",
    "fire",
    "lake",
    "mountain",
    "sky",
    "thunder",
    "thunder",
    "thunder"
   ]
  },
  {
   "product": "chaos",
   "materials": [
    "earth",
    "fire",
    "lake",
    "sky",
    "thunder",
    "thunder",
    "thunder",
    "water"
   ]
  },
  {
   "product": "Molten Lava",
   "materials": [
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "fire"
   ]
  },
  {
   "product": "Explosion",
   "materials": [
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "fire",
    "thunder",
    "thunder"
   ]
  },
  {
   "product": "Stormy Sea",
   "materials": [
    "earth",
    "earth",
    "earth",
    "lake",
    "sky",
    "thunder",
    "thunder",
    "water"
   ]
  },
  {
   "product": "Blast",
   "materials": [
    "Extreme Fire",
    "Hurricane",
    "Intensified Electricity",
    "Overcharged",
    "Singularity",
    "earth",
    "storm",
    "thunder"
   ]
  },
  {
   "product": "Hyperstorm",
   "materials": [
    "Lightning Storm",
    "Lightning Storm",
    "Lightning Storm",
    "Lightning Storm",
    "Maelstrom",
    "Maelstrom",
    "Maelstrom",
    "Maelstrom"
   ]
  },
  {
   "product": "Magnitude",
   "materials": [
    "Volcanic Eruption",
    "Volcanic Eruption",
    "Volcanic Eruption",
    "Volcanic Eruption",
    "Waterfall",
    "Waterfall",
    "Waterfall",
    "Waterfall"
   ]
  },
  {
   "product": "Stormy Ocean",
   "materials": [
    "earth",
    "earth",
    "earth",
    "lake",
    "mountain",
    "thunder",
    "water",
    "wind"
   ]
  },
  {
   "product": "Plasma",
   "materials": [
    "fire",
    "fire",
    "fire",
    "fire",
    "fire",
    "fire",
    "fire",
    "fire"
   ]
  },
  {
   "product": "Intense Inferno",
   "materials": [
    "fire",
    "fire",
    "fire",
    "fire",
    "fire",
    "fire",
    "sky",
    "sky"
   ]
  },
  {
   "product": "Overload",
   "materials": [
    "Overflow",
    "Overflow",
    "Overflow",
    "Overflow",
    "earth",
    "earth",
    "earth",
    "earth"
   ]
  },
  {
   "product": "Supernova",
   "materials": [
    "Aether",
    "Lightning",
    "N/A",
    "N/A",
    "chaos",
    "chaos",
    "mountain",
    "thunder"
   ]
  },
  {
   "product": "Infinite Lava",
   "materials": [
    "Molten Lava",
    "Molten Lava",
    "Molten Lava",
    "Molten Lava",
    "Molten Lava",
    "Molten Lava",
    "Molten Lava",
    "Molten Lava"
   ]
  },
  {
   "product": "Steam",
   "materials": [
    "earth",
    "earth",
    "earth",
    "earth",
    "fire",
    "fire",
    "sky",
    "water"
   ]
  },
  {
   "product": "Canyon",
   "materials": [
    "Blast",
    "Explosion",
    "Hyperstorm",
    "Magnitude",
    "Stormy Ocean",
    "Stormy Sea",
    "earth",
    "wind"
   ]
  },
  {
   "product": "Lightning Storm",
   "materials": [
    "earth",
    "earth",
    "earth",
    "sky",
    "thunder",
    "thunder",
    "thunder",
    "thunder"
   ]
  },
  {
   "product": "Nuclear Explosion",
   "materials": [
    "Intense Inferno",
    "Intense Inferno",
    "Intense Inferno",
    "Intense Inferno",
    "Plasma",
    "Plasma",
    "Plasma",
    "Plasma"
   ]
  },
  {
   "product": "Astral Disintegration",
   "materials": [
    "Canyon",
    "Infinite Lava",
    "Lightning Storm",
    "Nuclear Explosion",
    "Overload",
    "Steam",
    "Supernova",
    "wind"
   ]
  }
 ]
}

BH = {
 "team_token": "2544876c41de80488474ee6f64b3f25d",
 "target_product": "Black Hole",
 "recipes": [
  {
   "product": "Intense Inferno",
   "materials": [
    "fire",
    "fire",
    "fire",
    "fire",
    "fire",
    "fire",
    "sky",
    "sky"
   ]
  },
  {
   "product": "Planet",
   "materials": [
    "earth",
    "lake",
    "lake",
    "mountain",
    "sky",
    "sky",
    "wind",
    "wind"
   ]
  },
  {
   "product": "Black Hole",
   "materials": [
    "Intense Inferno",
    "Intense Inferno",
    "Intense Inferno",
    "Intense Inferno",
    "Planet",
    "Planet",
    "Planet",
    "Planet"
   ]
  }
 ]
}

ET = {
 "team_token": "2544876c41de80488474ee6f64b3f25d",
 "target_product": "Extreme Thunder",
 "recipes": [
  {
   "product": "Earthquake",
   "materials": [
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "thunder",
    "water"
   ]
  },
  {
   "product": "Extreme Thunder",
   "materials": [
    "Earthquake",
    "Earthquake",
    "Earthquake",
    "Earthquake",
    "thunder",
    "thunder",
    "thunder",
    "thunder"
   ]
  }
 ]
}

FU = {
 "team_token": "2544876c41de80488474ee6f64b3f25d",
 "target_product": "Fury",
 "recipes": [
  {
   "product": "Fury",
   "materials": [
    "lake",
    "lake",
    "sky",
    "sky",
    "sky",
    "thunder",
    "thunder",
    "thunder"
   ]
  }
 ]
}

ME = {
 "team_token": "2544876c41de80488474ee6f64b3f25d",
 "target_product": "Mega Explosion",
 "recipes": [
  {
   "product": "Molten Lava",
   "materials": [
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "fire"
   ]
  },
  {
   "product": "Explosion",
   "materials": [
    "earth",
    "earth",
    "earth",
    "earth",
    "earth",
    "fire",
    "thunder",
    "thunder"
   ]
  },
  {
   "product": "Mega Explosion",
   "materials": [
    "Explosion",
    "Explosion",
    "Explosion",
    "Explosion",
    "Molten Lava",
    "Molten Lava",
    "Molten Lava",
    "Molten Lava"
   ]
  }
 ]
}

PS = {
 "team_token": "2544876c41de80488474ee6f64b3f25d",
 "target_product": "Pyroclastic Storm",
 "recipes": [
  {
   "product": "Pyroclastic Storm",
   "materials": [
    "earth",
    "fire",
    "fire",
    "fire",
    "sky",
    "sky",
    "thunder",
    "water"
   ]
  }
 ]
}

all_elements = []
for d in NA, AD, BH, ET, FU, ME, PS:
    all_elements.extend(d['recipes'])

element_nodup = {}
for element in all_elements:
    element_nodup[element['product']] = element['materials']

used = set(('', 'earth', 'mountain', 'water', 'wind', 'Wind', 'thunder', 'fire', 'lake', 'sky'))
conseq = []
print(len(element_nodup))
while True:
    dels = []
    for e, materials in element_nodup.items():
        if not all(material in used for material in materials):
            continue

        conseq.append({"product": e, "materials": materials})
        dels.append(e)

    for dell in dels:
        used.add(dell)
        del element_nodup[dell]
    
    if len(element_nodup) == 0:
        break

result = {}
result['team_token'] = "2544876c41de80488474ee6f64b3f25d"
result['target_product'] = "`N/A`"
result['recipes'] = conseq

import json
print(json.dumps(result, indent=1, ensure_ascii=False))